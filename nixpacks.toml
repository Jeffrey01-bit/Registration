[phases.setup]
nixPkgs = ['php82', 'php82Packages.composer']

[phases.install]
cmds = [
  'apt-get update && apt-get install -y libssl-dev libsasl2-dev',
  'pecl install mongodb redis',
  'docker-php-ext-enable mongodb redis',
  'composer install --ignore-platform-req=ext-mongodb --ignore-platform-req=ext-redis --no-dev --optimize-autoloader'
]

[phases.build]
cmds = ['mkdir -p uploads', 'chmod 755 uploads']

[start]
cmd = 'php -S 0.0.0.0:$PORT'